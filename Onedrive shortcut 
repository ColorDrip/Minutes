import os
import win32com.client

def create_onedrive_shortcut():
    # Detect OneDrive folder (personal or business)
    onedrive_path = os.environ.get("OneDrive") or os.environ.get("OneDriveCommercial")

    if not onedrive_path:
        print("‚ö†Ô∏è OneDrive folder not found. Please ensure OneDrive is synced on your system.")
        return

    # Create folder on Desktop
    desktop = os.path.join(os.path.expanduser("~"), "Desktop")
    app_folder = os.path.join(desktop, "App")
    os.makedirs(app_folder, exist_ok=True)

    # Shortcut name and path
    shortcut_path = os.path.join(app_folder, "OneDrive Shortcut.lnk")

    # Create a Windows Shell shortcut
    shell = win32com.client.Dispatch("WScript.Shell")
    shortcut = shell.CreateShortCut(shortcut_path)
    shortcut.Targetpath = onedrive_path  # Folder path
    shortcut.WorkingDirectory = onedrive_path
    shortcut.IconLocation = "shell32.dll,3"  # Folder icon
    shortcut.save()

    print(f"‚úÖ Shortcut created successfully at: {shortcut_path}")
    print(f"üìÇ It points to: {onedrive_path}")

create_onedrive_shortcut()