import os
import win32com.client

# --- Step 1: Define the OneDrive folder path ---
# Replace this path with your actual OneDrive folder path.
# You can usually find it under: C:\Users\<YourUserName>\OneDrive\
onedrive_folder_path = os.path.expanduser(r"~\OneDrive\App")  

# Ensure the folder exists, or create it
if not os.path.exists(onedrive_folder_path):
    os.makedirs(onedrive_folder_path)
    print(f"üìÅ Created folder: {onedrive_folder_path}")

# --- Step 2: Define shortcut details ---
desktop = os.path.join(os.path.expanduser("~"), "Desktop")
shortcut_path = os.path.join(desktop, "App.lnk")

# --- Step 3: Create the shortcut using Windows Script Host ---
shell = win32com.client.Dispatch("WScript.Shell")
shortcut = shell.CreateShortCut(shortcut_path)
shortcut.Targetpath = onedrive_folder_path      # Folder to open
shortcut.WorkingDirectory = onedrive_folder_path
shortcut.IconLocation = "explorer.exe,0"        # File Explorer icon
shortcut.save()

print(f"‚úÖ Shortcut created successfully on Desktop: {shortcut_path}")