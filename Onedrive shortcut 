import os

def find_onedrive_path():
    """Find the user's local OneDrive path."""
    for var in ("OneDrive", "OneDriveCommercial", "OneDriveConsumer"):
        path = os.environ.get(var)
        if path and os.path.isdir(path):
            return path
    return None

def list_abc_folders():
    onedrive_path = find_onedrive_path()

    if not onedrive_path:
        print("‚ùå OneDrive folder not found. Please ensure OneDrive is installed and synced.")
        return

    print(f"‚úÖ OneDrive detected at: {onedrive_path}\n")

    # Look for folders in the top level of OneDrive that contain 'ABC' (case-insensitive)
    matching_folders = [
        os.path.join(onedrive_path, name)
        for name in os.listdir(onedrive_path)
        if os.path.isdir(os.path.join(onedrive_path, name)) and "abc" in name.lower()
    ]

    if matching_folders:
        print(f"üìÅ Found {len(matching_folders)} folder(s) containing 'ABC':\n")
        for folder in matching_folders:
            print(f"   ‚Ä¢ {folder}")
    else:
        print("‚ÑπÔ∏è No folders found with 'ABC' in their names.")

if __name__ == "__main__":
    list_abc_folders()