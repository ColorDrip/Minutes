from office365.sharepoint.client_context import ClientContext
from office365.runtime.auth.authentication_context import AuthenticationContext

# SharePoint site details
site_url = "https://yourtenant.sharepoint.com/sites/yoursite"
username = "your-email@yourtenant.com"
password = "your-password"

# Authenticate
auth_ctx = AuthenticationContext(site_url)
auth_ctx.acquire_token_for_user(username, password)
ctx = ClientContext(site_url, auth_ctx)

# Fetch data from a list
list_title = "YourListName"
sp_list = ctx.web.lists.get_by_title(list_title)
items = sp_list.items.get().execute_query()

# Print all items
for item in items:
    print(f"ID: {item.id}, Title: {item.properties.get('Title')}")